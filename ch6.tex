\chapter {Summary and Future Work}

% TODO: Plot of particle count vs publication date

\section{Summary}
The purpose of this dissertation has been to bridge the gap between planetesimal formation and the final assembly of terrestrial planets. As discussed in section \ref{sec:obsConstraints}, the observational markers of this phase of the planet formation processes are subtle and unlikely to be detectable in the present and near-future. For this reason, simulations will remain the most promising way forward. Due to the bottom-up nature of terrestrial planet growth, the number of particles that must be modeled as one goes back in time grows prohibitively large, particularly with an N-body approach. Using our state-of-the-art N-body code {\sc ChaNGa},we self-consistently follow the growth and orbital evolution of solid bodies from planetesimals to full-sized terrestrial planets for the first time.

Along the way, I reveal some shortcomings of previous planetesimal accretion and planet formation models that largely stem from prior computational constraints. In chapter \ref{ch:plSS}, I showed that the planetsimal accretion process itself is size-dependent. During the oligarchic growth phase, mean motion resonances with the largest bodies become populated by plantesimals, which shortens the timescale for energy equipatition, altering the growth mode and producing a broken power-law size distribution. This only occurs if the particle resolution is sufficiently fine-grained and is expected to operate for 100 km-sized and smaller bodies predicted by plantesimal formation models. I show that the exact location of the break depends on the initial planetesimal size and that the size distribution of the remaining small body populations in the solar system could potentially be used to constrain planetesimal formation mechanisms.

In chapter \ref{ch:grind}, I map out the collisional structure of a planetesimal belt perturbed by mean-motion resonances with a giant planet. After mapping the radial collision function to expected dust emission, I show that the presence of bright rings or gaps near the locations of resonances can be used to constrain the mass and eccentricity of the planet. This structure in the dust emission depends on interactions between planetesimals near the edges of the resonances and is only produceable if the simulated planetesimals are of near-realistic sizes.

Finally, in chapter \ref{ch:stipPl}, I use the incredible resolution afforded by {\sc ChaNGa} to follow the planetesimal growth process across a disk of solids spanning two orders of magnitude in orbital period, again starting from near-realistic sizes. At short orbital periods, energy equipartition becomes ineffective and oligarchic growth does not operate. This produces a boundary between accretion modes in the disk and breaks the self-similarity of the planetary embryo formation process, which is a common assumption used in terrestrial planet formation simulations. In chapter \ref{ch:stipFinal}, I pass the results of these simulations to a hybrid mixed-variable symplectic code to follow the planet growth process to completion. After doing so, I use the simulation snapshots to map the initial locations of planetesimals to the eventual planets that form and show that a migration-free terrestrial planet formation model produces a significant amount of radial mixing of material. In addition, I train a neural network to generate a much larger set of post-{\sc ChaNGa} snapshots and run these to completion. This provides a statistical sample from which I measure the planet occurrence rate as a function of orbital period. Similar to the occurrence rate measured by Kepler, my simulations produce a power law break around $\sim$ 10 days, which suggests that a large fraction of compact multiplanet systems may have formed in-situ.

\section{Future Work: Understanding the Behavior of Planetesimal-Driven Migration}

The migration history of a planet and its building blocks play a key role in determining its final composition, the eventual makeup of its atmosphere, and even its ability to harbor life. Up to this point in time, migration models have mainly focused on gas disk-driven interactions. Although this mechanism can play a definitive role in shaping the architectures of both terrestrial and gas giant systems, its influence only lasts for a small fraction of the planet-building phase, largely ending within the first few Myr. Beyond this point, migration can continue via weak but numerous gravitational interactions between the protoplanets and remaining planetesimals. This mechanism, known as planetesimal-driven migration (PDM), appears to have played a pivotal role in shaping the structure of the solar system \cite{tsiganis05, levison11, nesvorny11}, has been invoked to explain the near-resonant pairs of planets observed by Kepler \cite{chatterjee15}, and even has the potential to counteract gas disk migration \cite{minton14}. Despite the wide range of scenarios in which PDM is invoked, its behavior remains largely unexplored and has not yet been incorporated into any planetary population synthesis models. 

Much of this lack of attention to PDM stems from the fact that planetesimal interactions are often ignored in planet formation simulations due to computational expense. As I have shown in my thesis, dynamical interactions involving planetesimals also require sufficient resolution to properly operate. Compared to gas disk-driven migration, PDM requires far fewer modeling assumptions and is not directly coupled to the thermodynamic properties of the disk. For this reason, a thorough investigation of PDM using high resolution N-body simulations is a necessary step to fully understand the processes that transport solids throughout a planet-forming disk.

\section{Future Work: Pathways to Instability in Systems of Protoplanets}

In the standard picture of terrestrial planet formation, the final coalescence of protoplanets is typically delayed by the presence of gas in the disk. Where oligarchic growth operates, protoplanets stall at the `isolation mass'. Aerodynamic drag and gas dynamical friction prevent the protoplanets from \textbf{undergoing a large-scale gravitational instability that perturbs them} onto crossing orbits and \textbf{instigates the collisions which} form larger bodies. Because growth beyond a Mars mass is suspended while the protoplanetary gas is present, the planets that form in this region should fail to acquire a significant hydrogen envelope. While this delayed assembly picture is consistent with the properties of the inner solar system planets, recently discovered super-Earth and hot Jupiter systems require a more complicated explanation, often invoking migration.

Despite the crucial role that this delayed assembly model plays, the behavior and timing of the instability itself remains poorly understood. In cases where the gas and dust profile in the disk is non-monotonic, the instability could trigger only in select locations and spread to regions where substantial amounts of gas are still present. Studying this problem in more detail could be key to explaining a wide range of observational features, such as the radius gap \cite{fulton17}, bulk density measurements \cite{lopez14, wolfgang15} and atmospheric composition measurements by JWST.

In most cases, a smoothly varying `minimum mass solar nebula' (MMSN) disk model is used (e.g. \cite{kominami02, dawson15}), which triggers the instability everywhere once the gas density sufficiently decays. However, a MMSN model is not compatible with many exoplanetary systems \cite{chiang13, schlichting14}. As I showed in chapter \ref{ch:stipPl}, a smooth distribution of planetesimals does not always produce a smooth distribution of protoplanets. Furthermore, non-monotonic gas profiles are being invoked in protoplanetary disk models \cite{chatterjee14, ogihara15} and are even supported by observations of nearby disks with ALMA \cite{isella16, andrews16}. For these cases, the instability might trigger only in special places in the disk and could even spread to regions where substantial amounts of gas are still present. If protoplanetary cores in the terrestrial region can grow large enough to accrete gas before photoevaporation from the central star removes the majority of it, the need for migration in formation models for super-Earths and hot Jupiters would be greatly reduced.

\section{Toward a Fully Self-Consistent Simulation of Planet Formation}

\textbf{The work presented in this thesis represents the cutting edge of simulating the accumulation of solids into planet-sized bodies. In addition to resolution requirements, simulations of planet formation require a vast range of timescales to be resolved. To satisfy the resolution requirements, we have made use of the highly-parallel tree-based N-body code {\sc ChaNGa} to follow self-interactions between growing planetesimals and protoplanets at near-realistic resolution (100 km, which is on the upper end of predictions made by planetesimal formation model models). Much of the effort to implement a framework to handle collision detection between this vast of a collection of bodies was done in chapter \ref{ch:plSS}.}

\textbf{Due to the disparate timescales that need to be resolved in a planet-forming disk, the simulations presented in this thesis were largely limited by the number of timesteps that could be integrated in a reasonable amount of time. The simplest way to circumvent this issue is to artificially inflate the collision cross sections of particles, thereby reducing the growth timescale relative to the local dynamical time (which sets the minimum required timestep size). This approach was taken in chapters \ref{ch:plSS} and \ref{ch:stipPl}. In chapter \ref{ch:grind}, we made our first attempt at connecting the collision detection framework to the multi-tiered timestep capabilities of {\sc ChaNGa} (see \cite{menon15}) by only allowing particles undergoing near-collisions to evolve on the smaller step size.}

\textbf{In chapter \ref{ch:stipPl}, we modeled a growing planetesimal disk spanning two orders of magnitude in dynamical time from the inner to outer edge. To make these simulations computationally tractable, a new, multi-tiered timestepping condition was implemented in which a particle's step size is set by the present pericenter distance of its orbit. This was done to prevent particles on eccentric orbits from repeatedly `jumping' between discretized timesteps as they move between peri- and apocenter. This also introduced some complications with the onset of runaway growth in the disk, the details of which are described in section \ref{sec:timestep}.}

\textbf{Despite the improvements we made to {\sc ChaNGa}, the simulations presented in chapter \ref{ch:stipPl} would require billions of steps to reach planet formation timescales ($\sim$ Myr) when using a leapfrog integration scheme, which would require multiple years of wall time. To circumvent this, we run the {\sc ChaNGa} simulations until growth has proceeded such that the particle count reduces to $\sim 10^{4}$ and then pass the results to the MVS code {\sc genga}. Until recently, MVS codes have been unable to handle more than a few thousand self-interacting particles, but improvements in GPU hardware are quickly changing that. Some recent improvements to the code allowed for a 1.5 Gyr simulation of the inner solar system to be run using more than 60,000 particles \cite{grimm22}. A summary of improvements to the resolution and integration time capabilities of N-body simulations of planet formation is shown in table \ref{tab:nbody_improve}.}

\textbf{Lastly, the influence of a collision model which incorporates partial accretion events has yet to be fully understood, particularly in the context of STIPs. A model capturing the effects of more realistic collision outcomes has already been implemented in the tree-based code {\sc pkdgrav} \cite{leinhardt12, leinhardt15}, but has yet to be ported to {\sc ChaNGa}. One complication with this model is that the particle count can actually increase as growth proceeds, due to the production of debris. In doing so, some of the physical situations we modeled in this thesis may become computationally intractable. Taking advantage of the latest improvements in GPU hardware capabilities, however, may provide a path to circumvent this.}

\begin{table*}
\begin{center}
\caption{Highlights of Advances in N-body Simulations of Planet Growth}
\begin{tabularx}{1.0\textwidth}{l@{\extracolsep{\fill}}ccc} \hline \hline
Paper & N & t (yr) & Method \\ \hline
Lecar \& Aarseth (1986) & 200 & $6 \times 10^{4}$ & Direct (2-dimensional) \\
Kokubo \& Ida (1998) & 4,000 & 20,000 & Modified Hermite scheme \\
Richardson (2000) & $10^{6}$ & 1,000 & Tree-based \\
Kokubo (2002) & $10^{4}$ & $4 \times 10^{5}$ & Modified Hermite Scheme \\
Raymond \& Quinn (2005) & 380 & $200 \times 10^{6}$ & MVS \\
Barnes (2009) & $10^{5}$ & 90 & Tree-based (patch) \\
Wallace \& Quinn (2019) & $10^{6}$ &  20,000 & Tree-based \\
Grimm (2022) & 65,000 & $3.5 \times 10^{9}$ & MVS \\
Wallace \& Quinn (2022) & $10^{6}$ &  $10^{6}$ & Tree-based + MVS \\ \hline
\end{tabularx}\\
\begin{flushleft}
\end{flushleft}
\label{tab:nbody_improve}
\end{center}
\end{table*}